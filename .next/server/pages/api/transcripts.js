"use strict";(()=>{var e={};e.id=448,e.ids=[448],e.modules={3480:(e,t,r)=>{e.exports=r(5600)},3873:e=>{e.exports=require("path")},5600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6435:(e,t)=>{Object.defineProperty(t,"M",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},8667:(e,t)=>{Object.defineProperty(t,"A",{enumerable:!0,get:function(){return r}});var r=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})},9021:e=>{e.exports=require("fs")},9624:(e,t,r)=>{r.r(t),r.d(t,{config:()=>f,default:()=>p,routeModule:()=>g});var s={};r.r(s),r.d(s,{default:()=>d});var a=r(3480),n=r(8667),o=r(6435),i=r(9021),l=r.n(i),c=r(3873),u=r.n(c);async function d(e,t){if(t.setHeader("Access-Control-Allow-Origin","*"),t.setHeader("Access-Control-Allow-Methods","GET, POST, PUT, DELETE"),t.setHeader("Access-Control-Allow-Headers","Content-Type"),"GET"===e.method)try{let r=u().join(process.cwd(),"public","data","transcripts.json");if(!l().existsSync(r))return t.status(404).json({error:"Transcripts data file not found",message:"Please ensure transcripts.json exists in public/data/"});let s=l().readFileSync(r,"utf8"),a=JSON.parse(s).map(e=>({...e,serverTimestamp:new Date().toISOString(),id:e.id||Math.random().toString(36).substr(2,9),title:e.title||"Untitled Transcript",speaker:e.speaker||"Unknown Speaker",date:e.date||new Date().toISOString().split("T")[0]}));if(e.query.category&&"All"!==e.query.category&&(a=a.filter(t=>t.category===e.query.category)),e.query.speaker&&(a=a.filter(t=>t.speaker.toLowerCase().includes(e.query.speaker.toLowerCase()))),e.query.search){let t=e.query.search.toLowerCase();a=a.filter(e=>e.title.toLowerCase().includes(t)||e.description.toLowerCase().includes(t)||e.speaker.toLowerCase().includes(t)||e.category.toLowerCase().includes(t))}if(e.query.sort)switch(e.query.sort){case"newest":default:a.sort((e,t)=>new Date(t.date)-new Date(e.date));break;case"oldest":a.sort((e,t)=>new Date(e.date)-new Date(t.date));break;case"popular":a.sort((e,t)=>(t.downloads||0)-(e.downloads||0));break;case"title":a.sort((e,t)=>e.title.localeCompare(t.title))}let n=parseInt(e.query.page)||1,o=parseInt(e.query.limit)||50,i=(n-1)*o,c=i+o,d=a.slice(i,c);t.status(200).json({transcripts:d,pagination:{currentPage:n,totalPages:Math.ceil(a.length/o),totalItems:a.length,itemsPerPage:o,hasNextPage:c<a.length,hasPrevPage:n>1},filters:{category:e.query.category||null,speaker:e.query.speaker||null,search:e.query.search||null,sort:e.query.sort||"newest"},timestamp:new Date().toISOString()})}catch(e){console.error("Error fetching transcripts:",e),t.status(500).json({error:"Failed to fetch transcripts",message:e.message,timestamp:new Date().toISOString()})}else if("POST"===e.method)try{let r=e.body;if(!r.title||!r.speaker)return t.status(400).json({error:"Missing required fields",required:["title","speaker"]});let s=u().join(process.cwd(),"public","data","transcripts.json"),a=l().readFileSync(s,"utf8"),n=JSON.parse(a),o={id:Date.now(),...r,date:r.date||new Date().toISOString().split("T")[0],downloads:0,featured:!1};n.unshift(o),l().writeFileSync(s,JSON.stringify(n,null,2)),t.status(201).json({message:"Transcript created successfully",transcript:o})}catch(e){console.error("Error creating transcript:",e),t.status(500).json({error:"Failed to create transcript",message:e.message})}else t.setHeader("Allow",["GET","POST"]),t.status(405).json({error:`Method ${e.method} not allowed`})}let p=(0,o.M)(s,"default"),f=(0,o.M)(s,"config"),g=new a.PagesAPIRouteModule({definition:{kind:n.A.PAGES_API,page:"/api/transcripts",pathname:"/api/transcripts",bundlePath:"",filename:""},userland:s})}};var t=require("../../webpack-api-runtime.js");t.C(e);var r=t(t.s=9624);module.exports=r})();